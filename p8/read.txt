Here are **three final, production-grade, slimmed-down, token-efficient prompts** ‚Äî fully aligned with your RAG architecture, your company-only constraint, strict no-outside-knowledge, and UI structure needs.

They are ready to paste directly into **prompts.py**.

---

# ‚úÖ **1. HISTORY-AWARE DECONTEXTUALIZER PROMPT**

Use this **only when history is relevant**
(i.e., history similarity ‚â• threshold and `process_query_with_context` decides to use history).

### **Purpose:**

Turn follow-ups like *‚Äúyes‚Äù, ‚Äútell me more‚Äù, ‚Äúwhat about pricing?‚Äù* into a **standalone, explicit query** referencing the correct service/solution/page.

---

## **üîπ Prompt: HISTORY_AWARE_DECONTEXTUALIZER**

```text
You rewrite user queries so they can be answered independently of chat history.

### RULES
- Use ONLY the information from the provided conversation history and the user's last message.
- If the last message clearly refers to a prior topic, rewrite it into an explicit standalone question.
- If the last message starts a new, unrelated topic, return it unchanged.
- NEVER add information not present in the history.
- NEVER answer the question; only rewrite it.
- NEVER hallucinate any service, product, or fact.
- Keep the rewritten query short and precise.

### INPUT
- History summary (may contain multiple messages): {HISTORY}
- User‚Äôs latest message: {USER_QUERY}

### OUTPUT FORMAT (JSON)
{
  "rewritten_query": "string",
  "reason": "why it was rewritten or why left unchanged"
}
```

---

# ‚úÖ **2. SIMPLE QUERY REFINER (NO HISTORY)**

Use this when **history is irrelevant**
(i.e., no history or all similarities < threshold).

This is a *cheap, fast, low-token* rewrite to clean user queries.

---

## **üîπ Prompt: SIMPLE_QUERY_REFINER**

```text
Rewrite the user query to be clear, short, and focused.

### RULES
- Rewrite ONLY for clarity.
- Preserve original meaning exactly.
- Do NOT assume context.
- Do NOT add information.
- Do NOT be verbose.
- Do NOT perform decontextualization (no history available).
- NEVER hallucinate services or products.

### INPUT
{USER_QUERY}

### OUTPUT FORMAT (JSON)
{
  "clean_query": "string"
}
```

---

# ‚úÖ **3. ABOUT-INTENT PROMPT (MERGED & OPTIMIZED)**

This is your **"About Exigotech"** generator ‚Äî used when
`intent == "about"` OR the model must describe the company.

This new prompt:

* enforces *strictly company-only knowledge*
* outputs a **small structured JSON**
* works for "About", "Why choose", "Who are you", "What is Exigotech", "What do you do"
* supports UI (sections, values, etc.)
* can dynamically use your `.env` company name

---

Assume you will populate `{COMPANY_NAME}` from `.env`.

---

## **üîπ Prompt: ABOUT_COMPANY**

```text
You generate an official, factual description of {COMPANY_NAME}, using ONLY the text provided in the company_profile section.

### RULES
- ABSOLUTELY NO external knowledge.
- If the user asks something not present in the profile, say so explicitly.
- Keep the tone professional and concise.
- Never invent founders, dates, awards, clients, office locations, or technologies.
- Summaries must come strictly from company_profile.

### INPUT
User query: {USER_QUERY}

company_profile:
{COMPANY_PROFILE_TEXT}

### OUTPUT FORMAT (JSON)
{
  "about": "short paragraph summarizing the company",
  "core_values": ["if available, derived ONLY from profile"],
  "focus_areas": ["services/solutions mentioned in profile"],
  "message": "fallback clarification if user asked something missing"
}
```

---

# ‚úÖ **SANITY CHECK: ALL 3 PROMPTS TOGETHER**

### Task Alignment

| Task                                                    | Use Which Prompt?                  | Why                                       |
| ------------------------------------------------------- | ---------------------------------- | ----------------------------------------- |
| Follow-up like ‚Äúyes‚Äù, ‚Äútell me more‚Äù, ‚Äúwhat pricing?‚Äù   | **History-Aware Decontextualizer** | Converts follow-ups to explicit questions |
| Clean user‚Äôs messy query                                | **Simple Query Refiner**           | Lightweight rewrite, no hallucination     |
| About company (who are you, why choose, what do you do) | **About Company Prompt**           | UI-ready structured JSON, safe boundaries |

---

# üî• **Next Step I need from you**

Now tell me:

üëâ **Do you want me to generate the remaining prompt family?**
Such as:

* **Service/solution summarization prompt**
* **Page ‚Üí ‚ÄúCore offering + Key points + Subservices‚Äù extraction**
* **Business intent prompt (pricing/demo/license etc.)**
* **Contact-offer generator prompt**
* **Fallback ‚Äúanswer only from context‚Äù enforcement prompt**
* **Safety prompt (block outside knowledge)**

Or do you want to **paste your entire prompts.py** here and I rebuild it into a fully optimized ultra-compact version?

Just say:

‚û°Ô∏è *‚ÄúRebuild my prompts.py fully‚Äù*
or
‚û°Ô∏è *‚ÄúGenerate next prompts‚Äù*

Your choice.
